var ho;!function(e){var a;!function(e){var a;!function(e){function a(e,a){return void 0===a&&(a=window),e.split(".").map(function(e){a=a[e]}),a}e.get=a}(a=e.util||(e.util={}))}(a=e.classloader||(e.classloader={}))}(ho||(ho={}));var ho;!function(e){var a;!function(e){var a;!function(e){function a(e,a,o){void 0===o&&(o=!1);var n=e.split(".");e=n.pop();var r=window;if(n.map(function(e){r[e]=r[e]||{},r=r[e]}),r[e]){var s="Global object "+n.join(".")+"."+e+" already exists";if(o)throw s;console.info(s)}r[e]=a}e.expose=a}(a=e.util||(e.util={}))}(a=e.classloader||(e.classloader={}))}(ho||(ho={}));var ho;!function(e){var a;!function(a){var o;!function(a){function o(a){return new e.promise.Promise(function(e,o){var n=new XMLHttpRequest;n.onreadystatechange=function(){if(4==n.readyState){var a=n.responseText;200==n.status?e(a):o(a)}},n.open("GET",a),n.send()})}a.get=o}(o=a.xhr||(a.xhr={}))}(a=e.classloader||(e.classloader={}))}(ho||(ho={}));var ho;!function(e){var a;!function(e){var a=function(){function e(e,a){this.name=e.name,this.url=e.url||a(e.name),this.parent=e.parent||!0,this.expose=e.expose||!0,this["super"]=e["super"]}return e}();e.LoadArguments=a}(a=e.classloader||(e.classloader={}))}(ho||(ho={}));var ho;!function(e){var a;!function(e){!function(e){e[e.INFO=0]="INFO",e[e.ERROR=1]="ERROR"}(e.WarnLevel||(e.WarnLevel={}));var a=e.WarnLevel,o=function(){function o(o){void 0===o&&(o={}),this.loadType=o.loadType||e.LoadType.EVAL,this.urlTemplate=o.urlTemplate||"${name}.js",this.useDir="boolean"==typeof o.useDir?o.useDir:!0,this.useMin="boolean"==typeof o.useMin?o.useMin:!1,this.cache="boolean"==typeof o.cache?o.cache:!0,this.warnLevel=o.warnLevel||a.INFO}return o}();e.LoaderConfig=o}(a=e.classloader||(e.classloader={}))}(ho||(ho={}));var ho;!function(e){var a;!function(e){!function(e){e[e.SCRIPT=0]="SCRIPT",e[e.FUNCTION=1]="FUNCTION",e[e.EVAL=2]="EVAL"}(e.LoadType||(e.LoadType={}));e.LoadType}(a=e.classloader||(e.classloader={}))}(ho||(ho={}));var ho;!function(ho){var classloader;!function(classloader){classloader.mapping={};var ClassLoader=function(){function ClassLoader(e){this.conf={},this.cache={},this.conf=new classloader.LoaderConfig(e)}return ClassLoader.prototype.config=function(e){this.conf=new classloader.LoaderConfig(e)},ClassLoader.prototype.load=function(e){switch(e=new classloader.LoadArguments(e,this.resolveUrl.bind(this)),this.conf.loadType){case classloader.LoadType.SCRIPT:return this.load_script(e);case classloader.LoadType.FUNCTION:return this.load_function(e);case classloader.LoadType.EVAL:return this.load_eval(e)}},ClassLoader.prototype.load_script=function(e){function a(){var a=this;return new ho.promise.Promise(function(o,n){var r=e.url,s=document.createElement("script");s.onload=function(){"function"==typeof classloader.util.get(e.name)?o([classloader.util.get(e.name)]):n("Error while loading Class "+e.name)}.bind(a),s.src=r,document.getElementsByTagName("head")[0].appendChild(s)})}var o=this,n=[],r=new ho.promise.Promise;return this.conf.cache&&this.cache[e.name]?ho.promise.Promise.create([this.cache[e.name]]):(e.parent?this.getParentName(e.url).then(function(a){return-1!==e["super"].indexOf(a)?[]:o.load({name:a,parent:!0,expose:e.expose,"super":e["super"]})}).then(function(e){return n=e,a()}).then(function(a){o.conf.cache&&(o.cache[e.name]=a),n=n.concat(a),r.resolve(n)}):a().then(function(e){r.resolve(e)}),r)},ClassLoader.prototype.load_function=function(e){var a,o=this,n=[];return classloader.xhr.get(e.url).then(function(n){if(a=n,e.parent){var r=o.parseParentFromSource(n);return-1!==e["super"].indexOf(r)?[]:o.load({name:r,parent:!0,expose:e.expose,"super":e["super"]})}}).then(function(r){n=r;var s=a+"\nreturn "+e.name+"\n//# sourceURL="+window.location.href+e.url,t=new Function(s)();return e.expose&&classloader.util.expose(e.name,t,o.conf.warnLevel==classloader.WarnLevel.ERROR),t}).then(function(a){return o.conf.cache&&(o.cache[e.name]=a),n.push(a),n})},ClassLoader.prototype.load_eval=function(arg){var self=this,parents=[],source;return classloader.xhr.get(arg.url).then(function(e){if(source=e,arg.parent){var a=self.parseParentFromSource(e);return-1!==arg["super"].indexOf(a)?[]:self.load({name:a,parent:!0,expose:arg.expose,"super":arg["super"]})}}).then(function(p){parents=p;var ret="\n(function(){return "+arg.name+";})();",src=source+ret+"\n//# sourceURL="+window.location.href+arg.url,clazz=eval(src);return arg.expose&&classloader.util.expose(arg.name,clazz,self.conf.warnLevel==classloader.WarnLevel.ERROR),clazz}).then(function(e){return self.conf.cache&&(self.cache[arg.name]=e),parents.push(e),parents})},ClassLoader.prototype.getParentName=function(e){var a=this;return classloader.xhr.get(e).then(function(e){return a.parseParentFromSource(e)})},ClassLoader.prototype.parseParentFromSource=function(e){var a=/}\)\((.*)\);/,o=e.match(a);return o?o[1]:void 0},ClassLoader.prototype.resolveUrl=function(e){return classloader.mapping[e]?classloader.mapping[e]:(this.conf.useDir&&(e+="."+e.split(".").pop()),e=e.split(".").join("/"),this.conf.useMin&&(e+=".min"),this.conf.urlTemplate.replace("${name}",e))},ClassLoader.prototype.exists=function(e){return!!this.cache[e]},ClassLoader}();classloader.ClassLoader=ClassLoader}(classloader=ho.classloader||(ho.classloader={}))}(ho||(ho={}));var ho;!function(e){var a;!function(e){function a(e){n.config(e)}function o(e){return n.load(e)}var n=new e.ClassLoader;e.config=a,e.load=o}(a=e.classloader||(e.classloader={}))}(ho||(ho={}));