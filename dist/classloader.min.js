var ho;!function(e){var o;!function(e){var o;!function(e){function o(e,o){return void 0===o&&(o=window),e.split(".").map(function(e){o=o[e]}),o}e.get=o}(o=e.util||(e.util={}))}(o=e.classloader||(e.classloader={}))}(ho||(ho={}));var ho;!function(e){var o;!function(e){var o;!function(e){function o(e,o){var a=e.split(".");e=a.pop();var r=window;if(a.map(function(e){r[e]=r[e]||{}}),r[e])throw"Global object "+a.join(".")+"."+e+" already exists";r[e]=o}e.expose=o}(o=e.util||(e.util={}))}(o=e.classloader||(e.classloader={}))}(ho||(ho={}));var ho;!function(e){var o;!function(o){var a;!function(o){function a(o){return new e.promise.Promise(function(e,a){var r=new XMLHttpRequest;r.onreadystatechange=function(){if(4==r.readyState){var o=r.responseText;200==r.status?e(o):a(o)}},r.open("GET",o),r.send()})}o.get=a}(a=o.xhr||(o.xhr={}))}(o=e.classloader||(e.classloader={}))}(ho||(ho={}));var ho;!function(e){var o;!function(e){var o=function(){function e(e,o){this.name=e.name,this.url=e.url||o(e.name),this.parent=e.parent||!0,this.expose=e.expose||!0,this["super"]=e["super"]}return e}();e.LoadArguments=o}(o=e.classloader||(e.classloader={}))}(ho||(ho={}));var ho;!function(e){var o;!function(e){var o=function(){function o(o){void 0===o&&(o={}),this.loadType=o.loadType||e.LoadType.EVAL,this.urlTemplate=o.urlTemplate||"${name}.js",this.useDir="boolean"==typeof o.useDir?o.useDir:!0,this.useMin="boolean"==typeof o.useMin?o.useMin:!1,this.cache="boolean"==typeof o.cache?o.cache:!0}return o}();e.LoaderConfig=o}(o=e.classloader||(e.classloader={}))}(ho||(ho={}));var ho;!function(e){var o;!function(e){!function(e){e[e.SCRIPT=0]="SCRIPT",e[e.FUNCTION=1]="FUNCTION",e[e.EVAL=2]="EVAL"}(e.LoadType||(e.LoadType={}));e.LoadType}(o=e.classloader||(e.classloader={}))}(ho||(ho={}));var ho;!function(ho){var classloader;!function(classloader){classloader.mapping={};var ClassLoader=function(){function ClassLoader(e){this.conf={},this.cache={},this.conf=new classloader.LoaderConfig(e)}return ClassLoader.prototype.config=function(e){this.conf=new classloader.LoaderConfig(e)},ClassLoader.prototype.load=function(e){switch(e=new classloader.LoadArguments(e,this.resolveUrl.bind(this)),this.conf.loadType){case classloader.LoadType.SCRIPT:return this.load_script(e);case classloader.LoadType.FUNCTION:return this.load_function(e);case classloader.LoadType.EVAL:return this.load_eval(e)}},ClassLoader.prototype.load_script=function(e){function o(){var o=this;return new ho.promise.Promise(function(a,r){var n=e.url,s=document.createElement("script");s.onload=function(){"function"==typeof classloader.util.get(name)?a([classloader.util.get(name)]):r("Error while loading Class "+e.name)}.bind(o),s.src=n,document.getElementsByTagName("head")[0].appendChild(s)})}var a=this,r=[],n=new ho.promise.Promise;return this.conf.cache&&this.cache[e.name]?ho.promise.Promise.create([this.cache[e.name]]):(e.parent?this.getParentName(e.url).then(function(o){return e["super"]===o?[]:a.load({name:o,parent:!0,expose:e.expose,"super":e["super"]})}).then(function(e){r=e,o()}).then(function(o){a.conf.cache&&(a.cache[e.name]=o),r=r.concat(o),n.resolve(r)}):o().then(function(e){n.resolve(e)}),n)},ClassLoader.prototype.load_function=function(e){var o,a=this,r=[];return classloader.xhr.get(e.url).then(function(r){if(o=r,e.parent){var n=a.parseParentFromSource(r);return e["super"]===n?[]:a.load({name:n,parent:!0,expose:e.expose,"super":e["super"]})}}).then(function(a){r=a;var n=o+"\nreturn "+e.name+"\n//#sourceURL="+e.url,s=new Function(n)();return e.expose&&classloader.util.expose(e.name,s),s}).then(function(o){return a.conf.cache&&(a.cache[e.name]=o),r.push(o),r})},ClassLoader.prototype.load_eval=function(arg){var self=this,parents=[],source;return classloader.xhr.get(arg.url).then(function(e){if(source=e,arg.parent){var o=self.parseParentFromSource(e);return arg["super"]===o?[]:self.load({name:o,parent:!0,expose:arg.expose,"super":arg["super"]})}}).then(function(p){parents=p;var src=source+"\n//#sourceURL="+arg.url;return eval(source),classloader.util.get(arg.name)}).then(function(e){return self.conf.cache&&(self.cache[arg.name]=e),parents.push(e),parents})},ClassLoader.prototype.getParentName=function(e){var o=this;return classloader.xhr.get(e).then(function(e){return o.parseParentFromSource(e)})},ClassLoader.prototype.parseParentFromSource=function(e){var o=/}\)\((.*)\);/,a=e.match(o);return a?a[1]:void 0},ClassLoader.prototype.resolveUrl=function(e){return classloader.mapping[e]?classloader.mapping[e]:(this.conf.useDir&&(e+="."+e.split(".").pop()),e=e.split(".").join("/"),this.conf.useMin&&(e+=".min"),this.conf.urlTemplate.replace("${name}",e))},ClassLoader.prototype.exists=function(e){return!!this.cache[e]},ClassLoader}();classloader.ClassLoader=ClassLoader}(classloader=ho.classloader||(ho.classloader={}))}(ho||(ho={}));var ho;!function(e){var o;!function(e){function o(e){r.config(e)}function a(e){return r.load(e)}var r=new e.ClassLoader;e.config=o,e.load=a}(o=e.classloader||(e.classloader={}))}(ho||(ho={}));