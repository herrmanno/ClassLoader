var ho;!function(e){var o;!function(e){var o;!function(e){function o(e,o){return void 0===o&&(o=window),e.split(".").map(function(e){o=o[e]}),o}e.get=o}(o=e.util||(e.util={}))}(o=e.classloader||(e.classloader={}))}(ho||(ho={}));var ho;!function(e){var o;!function(e){var o;!function(e){function o(e,o){var a=e.split(".");e=a.pop();var n=window;if(a.map(function(e){n[e]=n[e]||{},n=n[e]}),n[e])throw"Global object "+a.join(".")+"."+e+" already exists";n[e]=o}e.expose=o}(o=e.util||(e.util={}))}(o=e.classloader||(e.classloader={}))}(ho||(ho={}));var ho;!function(e){var o;!function(o){var a;!function(o){function a(o){return new e.promise.Promise(function(e,a){var n=new XMLHttpRequest;n.onreadystatechange=function(){if(4==n.readyState){var o=n.responseText;200==n.status?e(o):a(o)}},n.open("GET",o),n.send()})}o.get=a}(a=o.xhr||(o.xhr={}))}(o=e.classloader||(e.classloader={}))}(ho||(ho={}));var ho;!function(e){var o;!function(e){var o=function(){function e(e,o){this.name=e.name,this.url=e.url||o(e.name),this.parent=e.parent||!0,this.expose=e.expose||!0,this["super"]=e["super"]}return e}();e.LoadArguments=o}(o=e.classloader||(e.classloader={}))}(ho||(ho={}));var ho;!function(e){var o;!function(e){var o=function(){function o(o){void 0===o&&(o={}),this.loadType=o.loadType||e.LoadType.EVAL,this.urlTemplate=o.urlTemplate||"${name}.js",this.useDir="boolean"==typeof o.useDir?o.useDir:!0,this.useMin="boolean"==typeof o.useMin?o.useMin:!1,this.cache="boolean"==typeof o.cache?o.cache:!0}return o}();e.LoaderConfig=o}(o=e.classloader||(e.classloader={}))}(ho||(ho={}));var ho;!function(e){var o;!function(e){!function(e){e[e.SCRIPT=0]="SCRIPT",e[e.FUNCTION=1]="FUNCTION",e[e.EVAL=2]="EVAL"}(e.LoadType||(e.LoadType={}));e.LoadType}(o=e.classloader||(e.classloader={}))}(ho||(ho={}));var ho;!function(ho){var classloader;!function(classloader){classloader.mapping={};var ClassLoader=function(){function ClassLoader(e){this.conf={},this.cache={},this.conf=new classloader.LoaderConfig(e)}return ClassLoader.prototype.config=function(e){this.conf=new classloader.LoaderConfig(e)},ClassLoader.prototype.load=function(e){switch(e=new classloader.LoadArguments(e,this.resolveUrl.bind(this)),this.conf.loadType){case classloader.LoadType.SCRIPT:return this.load_script(e);case classloader.LoadType.FUNCTION:return this.load_function(e);case classloader.LoadType.EVAL:return this.load_eval(e)}},ClassLoader.prototype.load_script=function(e){function o(){var o=this;return new ho.promise.Promise(function(a,n){var r=e.url,t=document.createElement("script");t.onload=function(){"function"==typeof classloader.util.get(e.name)?a([classloader.util.get(e.name)]):n("Error while loading Class "+e.name)}.bind(o),t.src=r,document.getElementsByTagName("head")[0].appendChild(t)})}var a=this,n=[],r=new ho.promise.Promise;return this.conf.cache&&this.cache[e.name]?ho.promise.Promise.create([this.cache[e.name]]):(e.parent?this.getParentName(e.url).then(function(o){return-1!==e["super"].indexOf(o)?[]:a.load({name:o,parent:!0,expose:e.expose,"super":e["super"]})}).then(function(e){return n=e,o()}).then(function(o){a.conf.cache&&(a.cache[e.name]=o),n=n.concat(o),r.resolve(n)}):o().then(function(e){r.resolve(e)}),r)},ClassLoader.prototype.load_function=function(e){var o,a=this,n=[];return classloader.xhr.get(e.url).then(function(n){if(o=n,e.parent){var r=a.parseParentFromSource(n);return-1!==e["super"].indexOf(r)?[]:a.load({name:r,parent:!0,expose:e.expose,"super":e["super"]})}}).then(function(a){n=a;var r=o+"\nreturn "+e.name+"\n//#sourceURL="+window.location.href+e.url,t=new Function(r)();return e.expose&&classloader.util.expose(e.name,t),t}).then(function(o){return a.conf.cache&&(a.cache[e.name]=o),n.push(o),n})},ClassLoader.prototype.load_eval=function(arg){var self=this,parents=[],source;return classloader.xhr.get(arg.url).then(function(e){if(source=e,arg.parent){var o=self.parseParentFromSource(e);return-1!==arg["super"].indexOf(o)?[]:self.load({name:o,parent:!0,expose:arg.expose,"super":arg["super"]})}}).then(function(p){parents=p;var ret="\n(function(){return "+arg.name+";})();",src=source+ret+"\n//#sourceURL="+window.location.href+arg.url,clazz=eval(src);return arg.expose&&classloader.util.expose(arg.name,clazz),clazz}).then(function(e){return self.conf.cache&&(self.cache[arg.name]=e),parents.push(e),parents})},ClassLoader.prototype.getParentName=function(e){var o=this;return classloader.xhr.get(e).then(function(e){return o.parseParentFromSource(e)})},ClassLoader.prototype.parseParentFromSource=function(e){var o=/}\)\((.*)\);/,a=e.match(o);return a?a[1]:void 0},ClassLoader.prototype.resolveUrl=function(e){return classloader.mapping[e]?classloader.mapping[e]:(this.conf.useDir&&(e+="."+e.split(".").pop()),e=e.split(".").join("/"),this.conf.useMin&&(e+=".min"),this.conf.urlTemplate.replace("${name}",e))},ClassLoader.prototype.exists=function(e){return!!this.cache[e]},ClassLoader}();classloader.ClassLoader=ClassLoader}(classloader=ho.classloader||(ho.classloader={}))}(ho||(ho={}));var ho;!function(e){var o;!function(e){function o(e){n.config(e)}function a(e){return n.load(e)}var n=new e.ClassLoader;e.config=o,e.load=a}(o=e.classloader||(e.classloader={}))}(ho||(ho={}));